<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>51单片机学习0x1 | Randolfluo's blog</title><meta name="author" content="Randolf luo"><meta name="copyright" content="Randolf luo"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="51单片机学习0x1">
<meta property="og:type" content="article">
<meta property="og:title" content="51单片机学习0x1">
<meta property="og:url" content="http://randolfluo.github.io/2024/02/05/51%E5%8D%95%E7%89%87%E6%9C%BA/51%E5%8D%95%E7%89%87%E6%9C%BA0x1/index.html">
<meta property="og:site_name" content="Randolfluo&#39;s blog">
<meta property="og:description" content="51单片机学习0x1">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://randolfluo.github.io/img/cover1.jpg">
<meta property="article:published_time" content="2024-02-05T13:42:00.000Z">
<meta property="article:modified_time" content="2024-07-11T16:00:00.000Z">
<meta property="article:author" content="Randolf luo">
<meta property="article:tag" content="单片机">
<meta property="article:tag" content="51单片机">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://randolfluo.github.io/img/cover1.jpg"><link rel="shortcut icon" href="/img/avater.jpg"><link rel="canonical" href="http://randolfluo.github.io/2024/02/05/51%E5%8D%95%E7%89%87%E6%9C%BA/51%E5%8D%95%E7%89%87%E6%9C%BA0x1/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css" media="print" onload="this.media='all'"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"top_n_per_article":1,"unescape":false,"languages":{"hits_empty":"未找到符合您查询的内容：${query}","hits_stats":"共找到 ${hits} 篇文章"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":false},
  copy: {
    success: '复制成功',
    error: '复制失败',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '天',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: {"limitCount":150,"languages":{"author":"作者: Randolf luo","link":"链接: ","source":"来源: Randolfluo's blog","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。"}},
  lightbox: 'null',
  Snackbar: {"chs_to_cht":"已切换为繁体中文","cht_to_chs":"已切换为简体中文","day_to_night":"已切换为深色模式","night_to_day":"已切换为浅色模式","bgLight":"#49b1f5","bgDark":"#1f1f1f","position":"bottom-left"},
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: true,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '51单片机学习0x1',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  isShuoshuo: false
}</script><meta name="generator" content="Hexo 7.3.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="/img/avater.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">111</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">33</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">34</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(/img/cover1.jpg);"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><span class="site-name">Randolfluo's blog</span></a><a class="nav-page-title" href="/"><span class="site-name">51单片机学习0x1</span></a></span><div id="menus"><div id="search-button"><span class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></span></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">51单片机学习0x1</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2024-02-05T13:42:00.000Z" title="发表于 2024-02-05 21:42:00">2024-02-05</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2024-07-11T16:00:00.000Z" title="更新于 2024-07-12 00:00:00">2024-07-12</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E5%8D%95%E7%89%87%E6%9C%BA/">单片机</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E5%8D%95%E7%89%87%E6%9C%BA/51%E5%8D%95%E7%89%87%E6%9C%BA/">51单片机</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">总字数:</span><span class="word-count">5k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>20分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">浏览量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><p>江科大51单片机学习笔记</p>
<h3 id="单片机"><a href="#单片机" class="headerlink" title="单片机"></a>单片机</h3><p>​    单片机不是完成某一个逻辑功能的芯片，而是把一个计算机系统集成到一个芯片上。相当于一个微型的计算机。</p>
<p><img src="https://randolfluo.oss-cn-guangzhou.aliyuncs.com/img/image-20240205164420483.png" alt="image-20240205164420483"></p>
<p>命名规则：</p>
<p><img src="https://randolfluo.oss-cn-guangzhou.aliyuncs.com/img/image-20240205171525348.png" alt="image-20240205171525348"></p>
<h4 id="51单片机"><a href="#51单片机" class="headerlink" title="51单片机"></a>51单片机</h4><p>　<code>51单片机</code>是对所有兼容<code>Intel8031指令系统</code>的单片机的统称，这一系列的单片机的始祖是Intel的<code>8031单片机</code>，后来随着flash ROM技术的发展，8031单片机取得了长足的进展成为了应用最广泛的8bit单片机之一，他的代表型号就是ATMEL公司的AT89系列。<img src="https://randolfluo.oss-cn-guangzhou.aliyuncs.com/img/d2389f408a88b749f84fd3622d5db44.jpg" alt="d2389f408a88b749f84fd3622d5db44"></p>
<h5 id="芯片"><a href="#芯片" class="headerlink" title="芯片"></a>芯片</h5><p>8051是一种8位元的单芯片微控制器，属于MCS-51单芯片的一种。8051单芯片是<code>同步式的顺序逻辑系统</code>，整个系统的工作完全是依赖系统内部的时脉信号，用以来产生各种动作周期及同步信号。</p>
<p><img src="https://randolfluo.oss-cn-guangzhou.aliyuncs.com/img/image-20240205174704298.png" alt="image-20240205174704298"></p>
<ul>
<li>看门狗：在单片机运行中，可能会遇到电磁场等恶劣环境干扰失控，造成程序进入死循环，程序跑飞(死机)等意外故障，程序的正常运行被打断，系统无法继续运行，陷入停滞状态，发生不可预料的后果。此时可通过按下复位按钮，强制系统复位。但更理想的实现是通过一套监控系统，实时监视MCU运行状态，在运行异常时，使系统摆脱故障状态。看门狗(Watchdog)技术能够解决这一问题。</li>
</ul>
<h5 id="单片机管脚图"><a href="#单片机管脚图" class="headerlink" title="单片机管脚图"></a>单片机管脚图</h5><p><img src="https://randolfluo.oss-cn-guangzhou.aliyuncs.com/img/image-20240205200323631.png" alt="image-20240205200323631"></p>
<p>引脚说明：</p>
<ul>
<li><p>主电源引脚</p>
<p>VCC：电源输入，接＋5V电源<br>GND：接地线</p>
</li>
<li><p>外接<code>晶振引脚</code><br>XTAL1，XTAL2</p>
</li>
<li><p>控制引脚<br>RST、PSEN、ALE/PROG、EA/Vpp</p>
</li>
<li><p>可编程输入/输出引脚<br>51单片机有4组8位的可编程I/O口，分别为P0、P1、P2、P3口，每个口有8位（8根引脚）(单片机为八位），共32根。</p>
</li>
</ul>
<p><img src="https://randolfluo.oss-cn-guangzhou.aliyuncs.com/img/image-20240205181205796.png" alt="image-20240205181205796"></p>
<h5 id="单片机最小系统"><a href="#单片机最小系统" class="headerlink" title="单片机最小系统"></a>单片机最小系统</h5><p>单片机最小系统也称为单片机最小应用系统，是指使用最少的原件组成单片机可以工作的系统</p>
<p>单片机最小系统的三要素为：<code>电源电路</code>、<code>晶振电路</code>和<code>复位电路</code>。</p>
<p><img src="https://randolfluo.oss-cn-guangzhou.aliyuncs.com/img/image-20240205182847541.png" alt="image-20240205182847541"></p>
<blockquote>
<p>小圆坑或者小标记所对应的引脚就是这个芯片的第 1脚，然后逆时针方向数下去，即 1 到最后一个引脚。</p>
</blockquote>
<ul>
<li><code>电源</code>：供电</li>
<li><code>晶振</code>：晶振，又叫晶体振荡器，从这个名字上就可以看出，它注定一生都要不停的振荡。它起到的作用是为单片机系统提供基准时钟信号。电容的作用是帮助晶振起振，并<strong>维持振荡信号的稳定</strong>。</li>
<li>复位电路：分为外部RST复位，软件复位，掉电复位/上电复位，看门狗复位。</li>
<li>寄存器是连接软硬件的媒介</li>
<li><p>在单片机中寄存器就是一段特殊的RAM存储器，一方面，寄存器可以存储和读取数据，另一方面，每一个寄存器背后都连接了一根导线，控制着电路的连接方式</p>
</li>
<li><p>寄存器相当于一个复杂机器的“操作按钮”</p>
</li>
</ul>
<h4 id="51单片机与stm32单片机的区别"><a href="#51单片机与stm32单片机的区别" class="headerlink" title="51单片机与stm32单片机的区别"></a>51单片机与stm32单片机的区别</h4><ul>
<li>51是8bit单片机，stm32是32bit单片机</li>
<li>51单片机采用<code>冯·诺依曼结构（von Neumann architecture）</code>，stm32单片机采用<code>普林斯顿体系结构（Princetion architecture）称作冯诺依曼体系</code></li>
<li>……</li>
</ul>
<blockquote>
<h2 id=""><a href="#" class="headerlink" title=""></a><img src="https://randolfluo.oss-cn-guangzhou.aliyuncs.com/img/v2-3333594d99b4c825d99737d7d771b99c_1440w.jpeg" alt="哈佛结构和冯诺依曼结构"></h2><p>冯·诺依曼体系和哈佛总线体系二者的区别就是程序空间和数据空间是否是一体的。</p>
<p>冯·诺依曼结构的处理器使用同一个存储器，经由同一个总线传输。</p>
<p>哈佛结构是一种将<strong>程序指令存储</strong>和<strong>数据存储</strong>分开的存储器结构,可以使<strong>指令和数据有不同的数据宽度</strong>。<br/></p>
<p>哈佛结构设计复杂，但效率高。冯诺依曼结构则比较简单，但也比较慢。</p>
<p>详细可查看此文章:<a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/85847486">哈佛结构和冯诺依曼结构 - 知乎 (zhihu.com)</a></p>
</blockquote>
<ul>
<li>GPIO</li>
</ul>
<p><strong>GPIO（general purpose intput output）</strong>是通用输入输出端口的简称，可以通过软件来控制其输入和输出。51 单片机芯片的 GPIO 引脚与外部设备连接起来，从而实现与外部通讯、控制以及数据采集的功能。</p>
<ul>
<li>特殊的数据类型</li>
</ul>
<p><img src="https://randolfluo.oss-cn-guangzhou.aliyuncs.com/img/image-20240206115058946.png" alt="image-20240206115058946"></p>
<ul>
<li><p><code>sfr</code>（special function register）：特殊功能寄存器声明</p>
<p>例：sfr P0 = 0x80;</p>
<p>声明P0口寄存器，物理地址为0x80</p>
</li>
<li><p><code>sbit</code>（special bit）：特殊位声明</p>
<p>例：sbit P0_1 = 0x81;  或  sbit P0_1 = P0^1;</p>
<p>声明P0寄存器的第1位</p>
</li>
</ul>
<p><img src="https://randolfluo.oss-cn-guangzhou.aliyuncs.com/img/image-20240226222902130.png" alt="image-20240226222902130"></p>
<ul>
<li><code>可位寻址/不可位寻址</code>：说白了就是可位寻址允许对寄存器某位操作，不可位寻址只能对某个寄存器进行整体赋值操作</li>
<li>对<code>不可位寻址的寄存器</code>，若要只操作其中一位而不影响其它位时，可用“&amp;=”、“|=”、“^=”的方法进行位操作</li>
</ul>
<ol>
<li><code>&amp;=</code>，101 &amp; 011 = 001，可用于置0，也可用于修改特定位</li>
<li><code>|=</code>，101 | 011 = 111，可用于置1</li>
<li><code>^=</code>，101 ^ 011 = 110，取反</li>
</ol>
<ul>
<li>对<code>可位寻址的寄存器</code>，可直接赋值，如P1_4=1。</li>
</ul>
<h3 id="LED"><a href="#LED" class="headerlink" title="LED"></a>LED</h3><p>发光二极管(Light Emitting Diode),它具有单向导电性.</p>
<p><img src="https://randolfluo.oss-cn-guangzhou.aliyuncs.com/img/image-20240205231346034.png" alt="image-20240205231346034"></p>
<p>在单片机中，1代表高电平，0代表低电平。由图可知， LED 采用共阳接法，即所有LED 阳极管脚接电源 VCC，当p2口为低电平时，产生电势差，LED发光。</p>
<p><img src="https://randolfluo.oss-cn-guangzhou.aliyuncs.com/img/image-20240205231725336.png" alt="image-20240205231725336"></p>
<p><img src="https://randolfluo.oss-cn-guangzhou.aliyuncs.com/img/697dd16c964ba808f82a101c1c64750.jpg" alt="697dd16c964ba808f82a101c1c64750"></p>
<p>图中电阻显示为102，实际值为1000。</p>
<p>电阻值为除最后一位+最后一位值*0.</p>
<p>由于单片机需要不停运行，查看汇编可知，在汇编代码结束前会返回到main函数开始处，因此单片机不会停止。</p>
<p><img src="https://randolfluo.oss-cn-guangzhou.aliyuncs.com/img/image-20240206140357310.png" alt="image-20240206140357310"></p>
<p>我们需要在<code>main</code>最后加个无限循环以保证单片机的正常运行。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;reg52.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;intrins.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> LED P2</span></span><br><span class="line">sbit LED1=P2^<span class="number">0</span>;  <span class="comment">//只修改LED1</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">Delay500ms</span><span class="params">(<span class="type">void</span>)</span>	<span class="comment">//@12.000MHz 可以设置参数调整时间为500ms的整数倍</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">char</span> data i, j, k;</span><br><span class="line"></span><br><span class="line">	_nop_();</span><br><span class="line">	i = <span class="number">4</span>;</span><br><span class="line">	j = <span class="number">205</span>;</span><br><span class="line">	k = <span class="number">187</span>;</span><br><span class="line">	<span class="keyword">do</span></span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">do</span></span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">while</span> (--k);</span><br><span class="line">		&#125; <span class="keyword">while</span> (--j);</span><br><span class="line">	&#125; <span class="keyword">while</span> (--i);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">int</span>  n=<span class="number">2</span>;</span><br><span class="line">	<span class="type">int</span> i=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">while</span>(n--)<span class="comment">//8个LED灯闪烁</span></span><br><span class="line">	&#123;</span><br><span class="line">		LED=<span class="number">0xFF</span>;</span><br><span class="line">		Delay500ms();</span><br><span class="line">		LED=<span class="number">0x00</span>;</span><br><span class="line">		Delay500ms();</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">	n=<span class="number">2</span>;</span><br><span class="line">	<span class="keyword">while</span>(n--)<span class="comment">//流水灯方式一</span></span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;<span class="number">8</span>;i++)</span><br><span class="line">			&#123;</span><br><span class="line">				LED=~(<span class="number">0x01</span>&lt;&lt;i);</span><br><span class="line">				Delay500ms();</span><br><span class="line">			&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	LED=~<span class="number">0x01</span>;<span class="comment">//流水灯方式二</span></span><br><span class="line">	Delay500ms();</span><br><span class="line">	n=<span class="number">2</span>;</span><br><span class="line">	<span class="keyword">while</span>(n--)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;<span class="number">7</span>;i++) </span><br><span class="line">			&#123;</span><br><span class="line">				LED=_crol_(LED,<span class="number">1</span>);<span class="comment">//_crol_函数相当于一个队列内循环移动</span></span><br><span class="line">				Delay500ms();</span><br><span class="line">			&#125;</span><br><span class="line">		<span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;<span class="number">7</span>;i++) </span><br><span class="line">			&#123;</span><br><span class="line">				LED=_cror_(LED,<span class="number">1</span>);</span><br><span class="line">				Delay500ms();</span><br><span class="line">			&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">while</span>(<span class="number">1</span>)</span><br><span class="line">		LED=<span class="number">0x00</span>;	<span class="comment">//LED全亮</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="独立按键控制"><a href="#独立按键控制" class="headerlink" title="独立按键控制"></a>独立按键控制</h3><p>按键是一种电子开关，使用时轻轻按开关按钮就可使开关接通，当松开手时, 开关断开。实现原理是通过轻触按键内部的金属弹片受力弹动来实现接通和断开。</p>
<p><img src="https://randolfluo.oss-cn-guangzhou.aliyuncs.com/img/image-20240206144137515.png" alt="image-20240206144137515">可以看到我们需要修改P3。</p>
<ul>
<li>对于机械开关，当机械触点断开、闭合时，由于机械触点的弹性作用，一个开关在闭合时不会马上稳定地接通，在断开时也不会一下子断开，所以在开关闭合及断开的瞬间会伴随一连串的抖动。</li>
</ul>
<p><img src="https://randolfluo.oss-cn-guangzhou.aliyuncs.com/img/image-20240206144523214.png" alt="image-20240206144523214"></p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;REGX52.H&gt;</span> 	<span class="comment">//此头文件包含单独对每个寄存器模块的控制</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;intrins.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> LED P2</span></span><br><span class="line">  </span><br><span class="line"><span class="type">void</span> <span class="title function_">Delay10ms</span><span class="params">(<span class="type">unsigned</span> <span class="type">int</span> n)</span>	<span class="comment">//delay</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> data i, j;</span><br><span class="line"><span class="keyword">while</span>(n--)&#123;</span><br><span class="line">	</span><br><span class="line"></span><br><span class="line">	i = <span class="number">117</span>;</span><br><span class="line">	j = <span class="number">184</span>;</span><br><span class="line">	<span class="keyword">do</span></span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">while</span> (--j);</span><br><span class="line">	&#125; <span class="keyword">while</span> (--i);</span><br><span class="line"></span><br><span class="line">	</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;			</span><br><span class="line">	<span class="type">int</span> n=<span class="number">3</span>;</span><br><span class="line">	<span class="type">int</span> i=<span class="number">0</span>;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">char</span> LEDNum=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">while</span>(<span class="number">1</span>)	<span class="comment">//不断对寄存器进行检测</span></span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">if</span>(P3_1==<span class="number">0</span>)		<span class="comment">//LED流水线，运行中不断加快</span></span><br><span class="line">		&#123;</span><br><span class="line">			LED=~<span class="number">0x01</span>;</span><br><span class="line">			Delay10ms(n*<span class="number">5</span>);</span><br><span class="line">			<span class="keyword">while</span>(n--)</span><br><span class="line">			&#123;</span><br><span class="line">				<span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;<span class="number">7</span>;i++) </span><br><span class="line">					&#123;</span><br><span class="line">						LED=_crol_(LED,<span class="number">1</span>);</span><br><span class="line">						Delay10ms(n*<span class="number">5</span>);</span><br><span class="line">					&#125;</span><br><span class="line">				<span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;<span class="number">7</span>;i++) </span><br><span class="line">					&#123;</span><br><span class="line">						LED=_cror_(LED,<span class="number">1</span>);</span><br><span class="line">						Delay10ms(n*<span class="number">5</span>);</span><br><span class="line">					&#125;</span><br><span class="line">			&#125;</span><br><span class="line">				LED=<span class="number">0xFF</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">if</span>(P3_0==<span class="number">0</span>)			<span class="comment">//LED按键控制全部LED灯</span></span><br><span class="line">		&#123;</span><br><span class="line">				Delay10ms(<span class="number">2</span>);<span class="comment">//消抖</span></span><br><span class="line">				<span class="keyword">while</span>(P3_0==<span class="number">0</span>);</span><br><span class="line">				Delay10ms(<span class="number">2</span>);</span><br><span class="line">				LED=~LED;</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span>(P3_2==<span class="number">0</span>)		<span class="comment">//实现二进制加法</span></span><br><span class="line">		&#123;</span><br><span class="line">				Delay10ms(<span class="number">2</span>);</span><br><span class="line">				<span class="keyword">while</span>(P3_2==<span class="number">0</span>);</span><br><span class="line">				Delay10ms(<span class="number">2</span>);</span><br><span class="line">				LED=~(LEDNum++);</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">	</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">if</span>(P3_3==<span class="number">0</span>)  <span class="comment">//LED左移与右移</span></span><br><span class="line">		&#123;	</span><br><span class="line">				Delay10ms(<span class="number">2</span>);</span><br><span class="line">				<span class="keyword">while</span>(P3_2==<span class="number">0</span>);</span><br><span class="line">				Delay10ms(<span class="number">2</span>);</span><br><span class="line">			LED=<span class="number">0xFE</span>;</span><br><span class="line">			<span class="keyword">while</span>(<span class="number">1</span>)</span><br><span class="line">				&#123;</span><br><span class="line">							<span class="keyword">if</span>(P3_0==<span class="number">0</span>)		<span class="comment">//左移</span></span><br><span class="line">							&#123;</span><br><span class="line">								Delay10ms(<span class="number">2</span>);</span><br><span class="line">								<span class="keyword">while</span>(P3_0==<span class="number">0</span>);</span><br><span class="line">								Delay10ms(<span class="number">2</span>);</span><br><span class="line">								LED=_cror_(LED,<span class="number">1</span>);</span><br><span class="line">							&#125;</span><br><span class="line">							</span><br><span class="line">							</span><br><span class="line">							<span class="keyword">if</span>(P3_2==<span class="number">0</span>)		<span class="comment">//右移</span></span><br><span class="line">							&#123;</span><br><span class="line">								Delay10ms(<span class="number">2</span>);</span><br><span class="line">								<span class="keyword">while</span>(P3_2==<span class="number">0</span>);</span><br><span class="line">								Delay10ms(<span class="number">2</span>);</span><br><span class="line">								LED=_crol_(LED,<span class="number">1</span>);</span><br><span class="line">							&#125;</span><br><span class="line">							</span><br><span class="line">							</span><br><span class="line">							<span class="keyword">if</span>(P3_1==<span class="number">0</span>)		<span class="comment">//退出</span></span><br><span class="line">							&#123;</span><br><span class="line">								Delay10ms(<span class="number">2</span>);</span><br><span class="line">								<span class="keyword">while</span>(P3_1==<span class="number">0</span>);</span><br><span class="line">								Delay10ms(<span class="number">2</span>);</span><br><span class="line">								<span class="keyword">break</span>;</span><br><span class="line">							&#125;</span><br><span class="line">								</span><br><span class="line">				&#125;</span><br><span class="line">				LED=<span class="number">0xFF</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="数码管"><a href="#数码管" class="headerlink" title="数码管"></a>数码管</h3><ul>
<li>LED数码管：数码管是一种简单、廉价的显示器，是由多个发光二极管封装在一起组成“8”字型的器件</li>
</ul>
<p><img src="https://randolfluo.oss-cn-guangzhou.aliyuncs.com/img/image-20240206161447902.png" alt="image-20240206161447902"></p>
<p>通过控制LED管来控制数码管的显示。<img src="https://randolfluo.oss-cn-guangzhou.aliyuncs.com/img/image-20240206161459131.png" alt="image-20240206161459131"></p>
<p>多个数码管共用引脚。</p>
<blockquote>
<p><code>74HC245</code>是一种三态输出、八路信号收发器，主要应用于大屏显示，以及其它的消费类电子产品中增加驱动。</p>
<p><code>74HC138</code>是常用的数字芯片，是一种3入8出译码器,三位表示八位。</p>
<p>这也是为什么LED采用共阳极接法，因为P2口输入的电流不够。LED灯采用共阴极接法亮度会小于共阴极接法。</p>
</blockquote>
<p><img src="https://randolfluo.oss-cn-guangzhou.aliyuncs.com/img/image-20240206162055956.png" alt="image-20240206162055956"></p>
<p><img src="https://randolfluo.oss-cn-guangzhou.aliyuncs.com/img/image-20240206170822230.png" alt="image-20240206170822230"></p>
<p>数码管的消隐(消音)：位选与段选的执行间的影响</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;REGX52.H&gt;</span> 	</span></span><br><span class="line"></span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> NixieTable[]=&#123;<span class="number">0x3F</span>,<span class="number">0x06</span>,<span class="number">0x5B</span>,<span class="number">0x4F</span>,<span class="number">0x66</span>,<span class="number">0x6D</span>,<span class="number">0x7D</span>,<span class="number">0x07</span>,<span class="number">0x7F</span>,<span class="number">0x6F</span>,<span class="number">0x77</span>,<span class="number">0x7C</span>,<span class="number">0x39</span>,<span class="number">0x5E</span>,<span class="number">0x79</span>,<span class="number">0x71</span>,<span class="number">0x00</span>&#125;;<span class="comment">//段码数据</span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">Delay</span><span class="params">(<span class="type">unsigned</span> <span class="type">int</span> xms)</span> <span class="comment">//delay</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">char</span> data i, j;</span><br><span class="line"><span class="keyword">while</span>(xms--)</span><br><span class="line">&#123;</span><br><span class="line">	i = <span class="number">2</span>;</span><br><span class="line">	j = <span class="number">239</span>;</span><br><span class="line">	<span class="keyword">do</span></span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">while</span> (--j);</span><br><span class="line">	&#125; <span class="keyword">while</span> (--i);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">Nixie</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span> Location,Number)</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="keyword">switch</span>(Location)	<span class="comment">//位选</span></span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">case</span> <span class="number">1</span>: P2_4=<span class="number">1</span>;P2_3=<span class="number">1</span>;P2_2=<span class="number">1</span>; <span class="keyword">break</span>;</span><br><span class="line">		<span class="keyword">case</span> <span class="number">2</span>: P2_4=<span class="number">1</span>;P2_3=<span class="number">1</span>;P2_2=<span class="number">0</span>; <span class="keyword">break</span>;</span><br><span class="line">		<span class="keyword">case</span> <span class="number">3</span>: P2_4=<span class="number">1</span>;P2_3=<span class="number">0</span>;P2_2=<span class="number">1</span>; <span class="keyword">break</span>;</span><br><span class="line">		<span class="keyword">case</span> <span class="number">4</span>: P2_4=<span class="number">1</span>;P2_3=<span class="number">0</span>;P2_2=<span class="number">0</span>; <span class="keyword">break</span>;</span><br><span class="line">		<span class="keyword">case</span> <span class="number">5</span>: P2_4=<span class="number">0</span>;P2_3=<span class="number">1</span>;P2_2=<span class="number">1</span>; <span class="keyword">break</span>;</span><br><span class="line">		<span class="keyword">case</span> <span class="number">6</span>: P2_4=<span class="number">0</span>;P2_3=<span class="number">1</span>;P2_2=<span class="number">0</span>; <span class="keyword">break</span>;</span><br><span class="line">		<span class="keyword">case</span> <span class="number">7</span>: P2_4=<span class="number">0</span>;P2_3=<span class="number">0</span>;P2_2=<span class="number">1</span>; <span class="keyword">break</span>;</span><br><span class="line">		<span class="keyword">case</span> <span class="number">8</span>: P2_4=<span class="number">0</span>;P2_3=<span class="number">0</span>;P2_2=<span class="number">0</span>; <span class="keyword">break</span>;	</span><br><span class="line">	&#125;</span><br><span class="line">	P0=NixieTable[Number];	<span class="comment">//传送段选数据</span></span><br><span class="line">	Delay(<span class="number">1</span>);	<span class="comment">//延时一段时间，等待显示稳定</span></span><br><span class="line">	P0=<span class="number">0x00</span>;;	<span class="comment">//消音</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">while</span>(<span class="number">1</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		Nixie(<span class="number">1</span>,<span class="number">1</span>);</span><br><span class="line">		Nixie(<span class="number">2</span>,<span class="number">1</span>);	</span><br><span class="line">		Nixie(<span class="number">3</span>,<span class="number">4</span>);</span><br><span class="line">		Nixie(<span class="number">4</span>,<span class="number">5</span>);	</span><br><span class="line">		Nixie(<span class="number">5</span>,<span class="number">1</span>);		</span><br><span class="line">		Nixie(<span class="number">6</span>,<span class="number">4</span>);	</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>单片机直接扫描：硬件设备简单，但会耗费大量的单片机CPU时间</li>
<li>专用驱动芯片：内部自带显存、扫描电路，单片机只需告诉它显示什么即可</li>
</ul>
<h3 id="模块化编程"><a href="#模块化编程" class="headerlink" title="模块化编程"></a>模块化编程</h3><ul>
<li><p>.c文件：函数、变量的定义</p>
</li>
<li><p>.h文件：可被外部调用的函数、变量的声明</p>
</li>
<li><p>任何自定义的变量、函数在调用前必须有定义或声明（同一个.c）</p>
</li>
<li><p>使用到的自定义函数的.c文件必须添加到工程参与编译</p>
</li>
<li><p>使用到的.h文件必须要放在编译器可寻找到的地方（工程文件夹根目录、安装目录、自定义）</p>
</li>
</ul>
<p><img src="https://randolfluo.oss-cn-guangzhou.aliyuncs.com/img/image-20240206182338861.png" alt="image-20240206182338861"></p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*			Delay.h				*/</span></span><br><span class="line"><span class="meta">#<span class="keyword">ifndef</span> __DELAY_H__</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __DELAY_H__</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">Delay</span><span class="params">(<span class="type">unsigned</span> <span class="type">int</span> xms)</span>;</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line"><span class="comment">/*			Delay.h				*/</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/*			Delay.c				*/</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">Delay</span><span class="params">(<span class="type">unsigned</span> <span class="type">int</span> xms)</span> <span class="comment">//delay</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">char</span> data i, j;</span><br><span class="line"><span class="keyword">while</span>(xms--)</span><br><span class="line">&#123;</span><br><span class="line">	i = <span class="number">2</span>;</span><br><span class="line">	j = <span class="number">239</span>;</span><br><span class="line">	<span class="keyword">do</span></span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">while</span> (--j);</span><br><span class="line">	&#125; <span class="keyword">while</span> (--i);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*			Delay.c				*/</span></span><br></pre></td></tr></table></figure>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*			Nixie.h				*/</span></span><br><span class="line"><span class="meta">#<span class="keyword">ifndef</span> __Nixie_H__</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __Nixie_H__</span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">Nixie</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span> Location,Number)</span>;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line"><span class="comment">/*			Nixie.h				*/</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/*			Nixie.c				*/</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;REGX52.H&gt;</span> 	</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;Delay.h&quot;</span></span></span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> NixieTable[]=&#123;<span class="number">0x3F</span>,<span class="number">0x06</span>,<span class="number">0x5B</span>,<span class="number">0x4F</span>,<span class="number">0x66</span>,<span class="number">0x6D</span>,<span class="number">0x7D</span>,<span class="number">0x07</span>,<span class="number">0x7F</span>,<span class="number">0x6F</span>,<span class="number">0x77</span>,<span class="number">0x7C</span>,<span class="number">0x39</span>,<span class="number">0x5E</span>,<span class="number">0x79</span>,<span class="number">0x71</span>,<span class="number">0x00</span>&#125;;<span class="comment">//段码数据</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">Nixie</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span> Location,Number)</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="keyword">switch</span>(Location)	<span class="comment">//位选</span></span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">case</span> <span class="number">1</span>: P2_4=<span class="number">1</span>;P2_3=<span class="number">1</span>;P2_2=<span class="number">1</span>; <span class="keyword">break</span>;</span><br><span class="line">		<span class="keyword">case</span> <span class="number">2</span>: P2_4=<span class="number">1</span>;P2_3=<span class="number">1</span>;P2_2=<span class="number">0</span>; <span class="keyword">break</span>;</span><br><span class="line">		<span class="keyword">case</span> <span class="number">3</span>: P2_4=<span class="number">1</span>;P2_3=<span class="number">0</span>;P2_2=<span class="number">1</span>; <span class="keyword">break</span>;</span><br><span class="line">		<span class="keyword">case</span> <span class="number">4</span>: P2_4=<span class="number">1</span>;P2_3=<span class="number">0</span>;P2_2=<span class="number">0</span>; <span class="keyword">break</span>;</span><br><span class="line">		<span class="keyword">case</span> <span class="number">5</span>: P2_4=<span class="number">0</span>;P2_3=<span class="number">1</span>;P2_2=<span class="number">1</span>; <span class="keyword">break</span>;</span><br><span class="line">		<span class="keyword">case</span> <span class="number">6</span>: P2_4=<span class="number">0</span>;P2_3=<span class="number">1</span>;P2_2=<span class="number">0</span>; <span class="keyword">break</span>;</span><br><span class="line">		<span class="keyword">case</span> <span class="number">7</span>: P2_4=<span class="number">0</span>;P2_3=<span class="number">0</span>;P2_2=<span class="number">1</span>; <span class="keyword">break</span>;</span><br><span class="line">		<span class="keyword">case</span> <span class="number">8</span>: P2_4=<span class="number">0</span>;P2_3=<span class="number">0</span>;P2_2=<span class="number">0</span>; <span class="keyword">break</span>;	</span><br><span class="line">	&#125;</span><br><span class="line">	P0=NixieTable[Number];	<span class="comment">//传送段选数据</span></span><br><span class="line">	Delay(<span class="number">1</span>);	<span class="comment">//延时一段时间，等待显示稳定</span></span><br><span class="line">	P0=<span class="number">0x00</span>;;	<span class="comment">//消音</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*			Nixie.c				*/</span></span><br></pre></td></tr></table></figure>
<h3 id="LCD1602-液晶屏"><a href="#LCD1602-液晶屏" class="headerlink" title="LCD1602 液晶屏"></a>LCD1602 液晶屏</h3><p><img src="https://randolfluo.oss-cn-guangzhou.aliyuncs.com/img/image-20240206185924491.png" alt="image-20240206185924491"></p>
<ul>
<li>LCD1602可以作为调试窗口</li>
</ul>
<div class="table-container">
<table>
<thead>
<tr>
<th><strong>函数</strong></th>
<th><strong>作用</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>LCD_Init();</td>
<td>初始化</td>
</tr>
<tr>
<td>LCD_ShowChar(1,1,’A’);</td>
<td>显示一个字符</td>
</tr>
<tr>
<td>LCD_ShowString(1,3,”Hello”);</td>
<td>显示字符串</td>
</tr>
<tr>
<td>LCD_ShowNum(1,9,123,3);</td>
<td>显示十进制数字</td>
</tr>
<tr>
<td>LCD_ShowSignedNum(1,13,-66,2);</td>
<td>显示有符号十进制数字</td>
</tr>
<tr>
<td>LCD_ShowHexNum(2,1,0xA8,2);</td>
<td>显示十六进制数字</td>
</tr>
<tr>
<td>LCD_ShowBinNum(2,4,0xAA,8);</td>
<td>显示二进制数字</td>
</tr>
</tbody>
</table>
</div>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;REGX52.H&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;Delay.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;lcd1602.h&quot;</span></span></span><br><span class="line"><span class="type">void</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">int</span> result;</span><br><span class="line">	LCD_Init();</span><br><span class="line">	LCD_ShowChar(<span class="number">1</span>,<span class="number">1</span>,<span class="string">&#x27;a&#x27;</span>);</span><br><span class="line">	LCD_ShowString(<span class="number">1</span>,<span class="number">3</span>,<span class="string">&quot;hello&quot;</span>);</span><br><span class="line">	</span><br><span class="line">	LCD_ShowSignedNum(<span class="number">1</span>,<span class="number">13</span>,<span class="number">-66</span>,<span class="number">2</span>);</span><br><span class="line">	LCD_ShowHexNum(<span class="number">2</span>,<span class="number">1</span>,<span class="number">0xA8</span>,<span class="number">2</span>);</span><br><span class="line">	LCD_ShowBinNum(<span class="number">2</span>,<span class="number">4</span>,<span class="number">0xAA</span>,<span class="number">8</span>);</span><br><span class="line">	<span class="keyword">while</span>(<span class="number">1</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		result++;</span><br><span class="line">	Delay(<span class="number">1000</span>);</span><br><span class="line">	LCD_ShowNum(<span class="number">1</span>,<span class="number">9</span>,result,<span class="number">3</span>);	</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="矩阵键盘"><a href="#矩阵键盘" class="headerlink" title="矩阵键盘"></a>矩阵键盘</h3><ul>
<li><p>在键盘中按键数量较多时，为了减少I/O口的占用，通常将按键排列成矩阵形式</p>
</li>
<li><p>采用逐行或逐列的“扫描”，就可以读出任何位置按键的状态</p>
</li>
</ul>
<p><img src="https://randolfluo.oss-cn-guangzhou.aliyuncs.com/img/image-20240206195612287.png" alt="image-20240206195612287"></p>
<h4 id="扫描的概念"><a href="#扫描的概念" class="headerlink" title="扫描的概念"></a>扫描的概念</h4><ul>
<li><p>数码管扫描（输出扫描）</p>
<p> 原理：显示第1位→显示第2位→显示第3位→……，然后快速循环这个过程，最终实现所有数码管同时显示的效果</p>
</li>
</ul>
<ul>
<li><p>矩阵键盘扫描（输入扫描）</p>
<p>原理：读取第1行(列)→读取第2行(列) →读取第3行(列) → ……，然后快速循环这个过程，最终实现所有按键被同时检测的假象</p>
</li>
<li><p>以上两种扫描方式的共性：节省I/O口</p>
</li>
</ul>
<p>采用逐行扫描,这里就直接copy了：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*							MatrixKey.c							*/</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;REGX52.H&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;Delay.h&quot;</span></span></span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> <span class="title function_">MatrixKey</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">char</span> KeyNumber=<span class="number">0</span>;</span><br><span class="line">	</span><br><span class="line">	P1=<span class="number">0xFF</span>;</span><br><span class="line">	P1_3=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">if</span>(P1_7==<span class="number">0</span>)&#123;Delay(<span class="number">20</span>);<span class="keyword">while</span>(P1_7==<span class="number">0</span>);Delay(<span class="number">20</span>);KeyNumber=<span class="number">1</span>;&#125;</span><br><span class="line">	<span class="keyword">if</span>(P1_6==<span class="number">0</span>)&#123;Delay(<span class="number">20</span>);<span class="keyword">while</span>(P1_6==<span class="number">0</span>);Delay(<span class="number">20</span>);KeyNumber=<span class="number">5</span>;&#125;</span><br><span class="line">	<span class="keyword">if</span>(P1_5==<span class="number">0</span>)&#123;Delay(<span class="number">20</span>);<span class="keyword">while</span>(P1_5==<span class="number">0</span>);Delay(<span class="number">20</span>);KeyNumber=<span class="number">9</span>;&#125;</span><br><span class="line">	<span class="keyword">if</span>(P1_4==<span class="number">0</span>)&#123;Delay(<span class="number">20</span>);<span class="keyword">while</span>(P1_4==<span class="number">0</span>);Delay(<span class="number">20</span>);KeyNumber=<span class="number">13</span>;&#125;</span><br><span class="line">	</span><br><span class="line">	P1=<span class="number">0xFF</span>;</span><br><span class="line">	P1_2=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">if</span>(P1_7==<span class="number">0</span>)&#123;Delay(<span class="number">20</span>);<span class="keyword">while</span>(P1_7==<span class="number">0</span>);Delay(<span class="number">20</span>);KeyNumber=<span class="number">2</span>;&#125;</span><br><span class="line">	<span class="keyword">if</span>(P1_6==<span class="number">0</span>)&#123;Delay(<span class="number">20</span>);<span class="keyword">while</span>(P1_6==<span class="number">0</span>);Delay(<span class="number">20</span>);KeyNumber=<span class="number">6</span>;&#125;</span><br><span class="line">	<span class="keyword">if</span>(P1_5==<span class="number">0</span>)&#123;Delay(<span class="number">20</span>);<span class="keyword">while</span>(P1_5==<span class="number">0</span>);Delay(<span class="number">20</span>);KeyNumber=<span class="number">10</span>;&#125;</span><br><span class="line">	<span class="keyword">if</span>(P1_4==<span class="number">0</span>)&#123;Delay(<span class="number">20</span>);<span class="keyword">while</span>(P1_4==<span class="number">0</span>);Delay(<span class="number">20</span>);KeyNumber=<span class="number">14</span>;&#125;</span><br><span class="line">	</span><br><span class="line">	P1=<span class="number">0xFF</span>;</span><br><span class="line">	P1_1=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">if</span>(P1_7==<span class="number">0</span>)&#123;Delay(<span class="number">20</span>);<span class="keyword">while</span>(P1_7==<span class="number">0</span>);Delay(<span class="number">20</span>);KeyNumber=<span class="number">3</span>;&#125;</span><br><span class="line">	<span class="keyword">if</span>(P1_6==<span class="number">0</span>)&#123;Delay(<span class="number">20</span>);<span class="keyword">while</span>(P1_6==<span class="number">0</span>);Delay(<span class="number">20</span>);KeyNumber=<span class="number">7</span>;&#125;</span><br><span class="line">	<span class="keyword">if</span>(P1_5==<span class="number">0</span>)&#123;Delay(<span class="number">20</span>);<span class="keyword">while</span>(P1_5==<span class="number">0</span>);Delay(<span class="number">20</span>);KeyNumber=<span class="number">11</span>;&#125;</span><br><span class="line">	<span class="keyword">if</span>(P1_4==<span class="number">0</span>)&#123;Delay(<span class="number">20</span>);<span class="keyword">while</span>(P1_4==<span class="number">0</span>);Delay(<span class="number">20</span>);KeyNumber=<span class="number">15</span>;&#125;</span><br><span class="line">	</span><br><span class="line">	P1=<span class="number">0xFF</span>;</span><br><span class="line">	P1_0=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">if</span>(P1_7==<span class="number">0</span>)&#123;Delay(<span class="number">20</span>);<span class="keyword">while</span>(P1_7==<span class="number">0</span>);Delay(<span class="number">20</span>);KeyNumber=<span class="number">4</span>;&#125;</span><br><span class="line">	<span class="keyword">if</span>(P1_6==<span class="number">0</span>)&#123;Delay(<span class="number">20</span>);<span class="keyword">while</span>(P1_6==<span class="number">0</span>);Delay(<span class="number">20</span>);KeyNumber=<span class="number">8</span>;&#125;</span><br><span class="line">	<span class="keyword">if</span>(P1_5==<span class="number">0</span>)&#123;Delay(<span class="number">20</span>);<span class="keyword">while</span>(P1_5==<span class="number">0</span>);Delay(<span class="number">20</span>);KeyNumber=<span class="number">12</span>;&#125;</span><br><span class="line">	<span class="keyword">if</span>(P1_4==<span class="number">0</span>)&#123;Delay(<span class="number">20</span>);<span class="keyword">while</span>(P1_4==<span class="number">0</span>);Delay(<span class="number">20</span>);KeyNumber=<span class="number">16</span>;&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">return</span> KeyNumber;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*							MatrixKey.c							*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*							MatrixKey.h							*/</span></span><br><span class="line"><span class="meta">#<span class="keyword">ifndef</span> __MATRIXKEY_H__</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __MATRIXKEY_H__</span></span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> <span class="title function_">MatrixKey</span><span class="params">()</span>;</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line"><span class="comment">/*							MatrixKey.h							*/</span></span><br></pre></td></tr></table></figure>
<h3 id="矩阵键盘密码锁-8位"><a href="#矩阵键盘密码锁-8位" class="headerlink" title="矩阵键盘密码锁(8位)"></a>矩阵键盘密码锁(8位)</h3><p>由于我们最大定义int整型，因此要采用两个password实现。然后每四位显示相隔，可以采用LCD_ShowChar()解决</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;REGX52.H&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;Delay.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;LCD1602.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;MatrixKey.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">char</span> KeyNum;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">int</span> Password1,Password2,Count;</span><br><span class="line">	</span><br><span class="line">		LCD_Init();</span><br><span class="line">		LCD_ShowString(<span class="number">1</span>,<span class="number">1</span>,<span class="string">&quot;PASSWORD:&quot;</span>);	</span><br><span class="line">	<span class="keyword">while</span>(<span class="number">1</span>)</span><br><span class="line">	&#123;</span><br><span class="line">	</span><br><span class="line">		KeyNum=MatrixKey();</span><br><span class="line">		<span class="keyword">if</span>(KeyNum)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">if</span>(KeyNum&lt;=<span class="number">10</span>)   <span class="comment">//输入密码</span></span><br><span class="line">			&#123;</span><br><span class="line">				<span class="keyword">if</span>(Count&lt;<span class="number">4</span>)		<span class="comment">//password1</span></span><br><span class="line">				&#123;</span><br><span class="line">					Password1*=<span class="number">10</span>;</span><br><span class="line">					Password1+=KeyNum%<span class="number">10</span>;</span><br><span class="line">					Count++;</span><br><span class="line">				&#125;</span><br><span class="line">				LCD_ShowNum(<span class="number">2</span>,<span class="number">1</span>,Password1,<span class="number">4</span>);</span><br><span class="line">				</span><br><span class="line">				<span class="keyword">if</span>(Count&gt;<span class="number">4</span>&amp;&amp;Count&lt;=<span class="number">8</span>)	<span class="comment">//password2</span></span><br><span class="line">				&#123;</span><br><span class="line">					Password2*=<span class="number">10</span>;</span><br><span class="line">					Password2+=KeyNum%<span class="number">10</span>;</span><br><span class="line">					Count++;</span><br><span class="line">				&#125;</span><br><span class="line">				LCD_ShowNum(<span class="number">2</span>,<span class="number">5</span>,Password2,<span class="number">4</span>);</span><br><span class="line">				<span class="keyword">if</span>(Count==<span class="number">4</span>)</span><br><span class="line">				Count++;		</span><br><span class="line">			&#125;</span><br><span class="line">						</span><br><span class="line">			<span class="keyword">if</span>(KeyNum==<span class="number">11</span>)			<span class="comment">//确认按钮</span></span><br><span class="line">			&#123;<span class="keyword">if</span>(Password1==<span class="number">1234</span>&amp;&amp;Password2==<span class="number">5678</span>)	</span><br><span class="line">				&#123;</span><br><span class="line">					LCD_ShowString(<span class="number">1</span>,<span class="number">14</span>,<span class="string">&quot;OK &quot;</span>);	</span><br><span class="line">					Password1=<span class="number">0</span>;</span><br><span class="line">					Password2=<span class="number">0</span>;		</span><br><span class="line">					Count=<span class="number">0</span>;		</span><br><span class="line">					LCD_ShowNum(<span class="number">2</span>,<span class="number">1</span>,Password1,<span class="number">4</span>);	</span><br><span class="line">					LCD_ShowNum(<span class="number">2</span>,<span class="number">5</span>,Password2,<span class="number">4</span>);</span><br><span class="line">				&#125;</span><br><span class="line">				<span class="keyword">else</span>				</span><br><span class="line">				&#123;</span><br><span class="line">					LCD_ShowString(<span class="number">1</span>,<span class="number">14</span>,<span class="string">&quot;ERR&quot;</span>);</span><br><span class="line">					Password1=<span class="number">0</span>;</span><br><span class="line">					Password2=<span class="number">0</span>;					</span><br><span class="line">					Count=<span class="number">0</span>;		</span><br><span class="line">					LCD_ShowNum(<span class="number">2</span>,<span class="number">1</span>,Password1,<span class="number">4</span>);	</span><br><span class="line">					LCD_ShowNum(<span class="number">2</span>,<span class="number">5</span>,Password2,<span class="number">4</span>);</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">if</span>(KeyNum==<span class="number">12</span>)		<span class="comment">//重置按钮</span></span><br><span class="line">			&#123;</span><br><span class="line">					Password1=<span class="number">0</span>;</span><br><span class="line">					Password2=<span class="number">0</span>;					</span><br><span class="line">					Count=<span class="number">0</span>;		</span><br><span class="line">					LCD_ShowNum(<span class="number">2</span>,<span class="number">1</span>,Password1,<span class="number">4</span>);	</span><br><span class="line">					LCD_ShowNum(<span class="number">2</span>,<span class="number">5</span>,Password2,<span class="number">4</span>);</span><br><span class="line">			&#125;</span><br><span class="line">			</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="定时器"><a href="#定时器" class="headerlink" title="定时器"></a>定时器</h3><ul>
<li>定时器介绍：51单片机的定时器属于单片机的内部资源，其电路的连接和运转均在单片机内部完成。</li>
</ul>
<p><img src="https://randolfluo.oss-cn-guangzhou.aliyuncs.com/img/image-20240206230629247.png" alt="image-20240206230629247"></p>
<ul>
<li>定时器个数2个（T0、T1、T2），不同单片机个数不同。</li>
</ul>
<p><img src="https://randolfluo.oss-cn-guangzhou.aliyuncs.com/img/image-20240206232058529.png" alt="image-20240206232058529"></p>
<ul>
<li>SYSclk：系统时钟，即晶振周期，本开发板上的晶振为12MHz</li>
</ul>
<h4 id="CPU-时序的有关知识"><a href="#CPU-时序的有关知识" class="headerlink" title="CPU 时序的有关知识"></a>CPU 时序的有关知识</h4><ul>
<li>在计算机体系结构和微处理器设计中，有几个与时间周期相关的概念，它们是：<ul>
<li><strong>振荡周期</strong>（Oscillation Cycle）：<ul>
<li>振荡周期也称为时钟周期，是指时钟振荡器产生的一个完整的周期的时间。它是处理器内部操作的基本时间单位。</li>
</ul>
</li>
<li><strong>状态周期</strong>（State Cycle）：<ul>
<li>状态周期是处理器内部操作的一个更细分的时序单位。</li>
</ul>
</li>
<li><strong>机器周期</strong>（Machine Cycle）：<ul>
<li>机器周期是执行一个基本机器指令所需的时间。</li>
</ul>
</li>
<li><strong>指令周期</strong>（Instruction Cycle）：<ul>
<li>指令周期是处理器从取指令到执行完该指令所需的全部时间。</li>
</ul>
</li>
</ul>
</li>
<li>例如：外接晶振为 12MHz 时，51 单片机相关周期的具体值为：<br>振荡周期=1/12us;<br>状态周期=1/6us;<br>机器周期=1us;<br>指令周期=1~4us;</li>
</ul>
<p><img src="https://randolfluo.oss-cn-guangzhou.aliyuncs.com/img/image-20240206231726875.png" alt="image-20240206231726875"></p>
<h4 id="中断系统"><a href="#中断系统" class="headerlink" title="中断系统"></a>中断系统</h4><p><img src="https://randolfluo.oss-cn-guangzhou.aliyuncs.com/img/image-20240206233034271.png" alt="image-20240206233034271"></p>
<ul>
<li>STC89C52中断资源</li>
</ul>
<p><img src="https://randolfluo.oss-cn-guangzhou.aliyuncs.com/img/image-20240206233407160.png" alt="image-20240206233407160"></p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*									timer0.c									*/</span>		</span><br><span class="line"><span class="type">void</span> <span class="title function_">Timer0Init</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">TMOD|=<span class="number">0X01</span>;<span class="comment">//选择为定时器 0 模式，工作方式 1</span></span><br><span class="line">TH0=<span class="number">0XFC</span>; <span class="comment">//给定时器赋初值，定时 1ms</span></span><br><span class="line">TL0=<span class="number">0X18</span>; <span class="comment">//给定时器赋初值，定时 1ms</span></span><br><span class="line">ET0=<span class="number">1</span>;<span class="comment">//打开定时器 0 中断允许</span></span><br><span class="line">EA=<span class="number">1</span>;<span class="comment">//打开总中断</span></span><br><span class="line">TR0=<span class="number">1</span>;<span class="comment">//打开定时器</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//详看普中51单片机开发攻略第21章与19章</span></span><br><span class="line"><span class="comment">/*									timer0.c									*/</span>		</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/*									main.c										*/</span>		</span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;REGX52.H&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;Delay.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;LCD1602.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;Timer0.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> Sec=<span class="number">14</span>,Min=<span class="number">45</span>,Hour=<span class="number">11</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">	LCD_Init();</span><br><span class="line">	Timer0Init();</span><br><span class="line">	</span><br><span class="line">	LCD_ShowString(<span class="number">1</span>,<span class="number">1</span>,<span class="string">&quot;Clock:&quot;</span>);	</span><br><span class="line">	LCD_ShowString(<span class="number">1</span>,<span class="number">8</span>,<span class="string">&quot;  :  :&quot;</span>);</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">while</span>(<span class="number">1</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		LCD_ShowNum(<span class="number">1</span>,<span class="number">8</span>,Hour,<span class="number">2</span>);	</span><br><span class="line">		LCD_ShowNum(<span class="number">1</span>,<span class="number">11</span>,Min,<span class="number">2</span>);</span><br><span class="line">		LCD_ShowNum(<span class="number">1</span>,<span class="number">14</span>,Sec,<span class="number">2</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Timer0_Routine</span><span class="params">()</span> interrupt 1</span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">static</span> <span class="type">unsigned</span> <span class="type">int</span> T0Count;</span><br><span class="line">    TL0 = <span class="number">0x18</span>;		</span><br><span class="line">	TH0 = <span class="number">0xFC</span>;		<span class="comment">//重新设置定时初值</span></span><br><span class="line">	T0Count++;</span><br><span class="line">	<span class="keyword">if</span>(T0Count&gt;=<span class="number">1000</span>)	<span class="comment">//定时器分频，1s</span></span><br><span class="line">	&#123;</span><br><span class="line">		T0Count=<span class="number">0</span>;</span><br><span class="line">		Sec++;			<span class="comment">//1秒到，Sec自增</span></span><br><span class="line">		<span class="keyword">if</span>(Sec&gt;=<span class="number">60</span>)</span><br><span class="line">		&#123;</span><br><span class="line">			Sec=<span class="number">0</span>;		<span class="comment">//60秒到，Sec清0，Min自增</span></span><br><span class="line">			Min++;</span><br><span class="line">			<span class="keyword">if</span>(Min&gt;=<span class="number">60</span>)</span><br><span class="line">			&#123;</span><br><span class="line">				Min=<span class="number">0</span>;	<span class="comment">//60分钟到，Min清0，Hour自增</span></span><br><span class="line">				Hour++;</span><br><span class="line">				<span class="keyword">if</span>(Hour&gt;=<span class="number">24</span>)</span><br><span class="line">				&#123;</span><br><span class="line">					Hour=<span class="number">0</span>;	<span class="comment">//24小时到，Hour清0</span></span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*									main.c										*/</span>		</span><br></pre></td></tr></table></figure>
<h3 id="串口"><a href="#串口" class="headerlink" title="串口"></a>串口</h3><ul>
<li>串口是一种应用十分广泛的通讯接口，串口成本低、容易使用、通信线路简单，可实现两个设备的互相通信。</li>
<li>串行通信是指使用一条数据线，将数据一位一位地依次传输，每一位数据占据一个固定的时间长度。</li>
</ul>
<p><img src="https://randolfluo.oss-cn-guangzhou.aliyuncs.com/img/image-20240207134936370.png" alt="image-20240207134936370"></p>
<h4 id="电平标准"><a href="#电平标准" class="headerlink" title="电平标准"></a>电平标准</h4><ul>
<li><p>电平标准是数据1和数据0的表达方式，是传输线缆中人为规定的电压与数据的对应关系，串口常用的电平标准有如下三种：</p>
</li>
<li><p>TTL电平：+5V表示1，0V表示0</p>
</li>
<li><p>RS232电平：-3-15V表示1，+3~+15V表示0</p>
</li>
<li><p>RS485电平：两线压差+2+6V表示1，-2-6V表示0（差分信号）</p>
</li>
</ul>
<h4 id="通信术语"><a href="#通信术语" class="headerlink" title="通信术语"></a>通信术语</h4><ul>
<li><p>全双工：通信双方可以在同一时刻互相传输数据</p>
</li>
<li><p>半双工：通信双方可以互相传输数据，但必须分时复用一根数据线</p>
</li>
<li><p>单工：通信只能有一方发送到另一方，不能反向传输</p>
</li>
<li><p>异步：通信双方各自约定通信速率</p>
</li>
<li><p>同步：通信双方靠一根时钟线来约定通信速率</p>
</li>
<li><p>总线：连接各个设备的数据传输线路（类似于一条马路，把路边各住户连接起来，使住户可以相互交流）</p>
</li>
</ul>
<h4 id="常见通信接口"><a href="#常见通信接口" class="headerlink" title="常见通信接口"></a>常见通信接口</h4><div class="table-container">
<table>
<thead>
<tr>
<th><strong>名称</strong></th>
<th><strong>引脚定义</strong></th>
<th><strong>通信方式</strong></th>
<th><strong>特点</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>UART</td>
<td>TXD、RXD</td>
<td>全双工、异步</td>
<td>点对点通信</td>
</tr>
<tr>
<td>I²C</td>
<td>SCL、SDA</td>
<td>半双工、同步</td>
<td>可挂载多个设备</td>
</tr>
<tr>
<td>SPI</td>
<td>SCLK、MOSI、MISO、CS</td>
<td>全双工、同步</td>
<td>可挂载多个设备</td>
</tr>
<tr>
<td>1-Wire</td>
<td>DQ</td>
<td>半双工、异步</td>
<td>可挂载多个设备</td>
</tr>
</tbody>
</table>
</div>
<p><img src="https://randolfluo.oss-cn-guangzhou.aliyuncs.com/img/image-20240225155359895.png" alt="image-20240225155359895"></p>
<ul>
<li><p>波特率：串口通信的速率（发送和接收各数据位的间隔时间）</p>
</li>
<li><p>检验位：用于数据验证</p>
</li>
<li><p>停止位：用于数据帧间隔</p>
</li>
</ul>
<p><img src="https://randolfluo.oss-cn-guangzhou.aliyuncs.com/img/image-20240207170848460.png" alt="image-20240207170848460"></p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*									main.c									*/</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;REGX52.H&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;Delay.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;UART.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">	UART_Init();</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">while</span>(<span class="number">1</span>)</span><br><span class="line">	&#123;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">UART_Routine</span><span class="params">()</span>		interrupt 4</span><br><span class="line">&#123;</span><br><span class="line">	<span class="keyword">if</span>(RI == <span class="number">1</span>)	<span class="comment">//判断接收</span></span><br><span class="line">	&#123;</span><br><span class="line">		P2=SBUF;</span><br><span class="line">		UART_SendByte(SBUF);</span><br><span class="line">		RI=<span class="number">0</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*									main.c									*/</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/*									UART.c									*/</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;REGX52.H&gt;</span></span></span><br><span class="line"><span class="type">void</span> <span class="title function_">UART_Init</span><span class="params">(<span class="type">void</span>)</span>	<span class="comment">//4800bps@12.000MHz</span></span><br><span class="line">&#123;</span><br><span class="line">	PCON |= <span class="number">0x80</span>;		<span class="comment">//使能波特率倍速位SMOD</span></span><br><span class="line">	SCON = <span class="number">0x50</span>;  	<span class="comment">//8位数据,可变波特率 </span></span><br><span class="line">	TMOD &amp;= <span class="number">0x0F</span>;		<span class="comment">//设置定时器模式</span></span><br><span class="line">	TMOD |= <span class="number">0x20</span>;		<span class="comment">//设置定时器模式</span></span><br><span class="line">	TL1 = <span class="number">0xF4</span>;			<span class="comment">//设置定时初始值</span></span><br><span class="line">	TH1 = <span class="number">0xF4</span>;			<span class="comment">//设置定时重载值</span></span><br><span class="line">	ET1 = <span class="number">0</span>;			<span class="comment">//禁止定时器中断</span></span><br><span class="line">	TR1 = <span class="number">1</span>;			<span class="comment">//定时器1开始计时</span></span><br><span class="line">	EA = <span class="number">1</span>;				<span class="comment">//开放中断，接受数据开启				</span></span><br><span class="line">	ES = <span class="number">1</span>;				<span class="comment">//允许串行口中断，接受数据开启</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">UART_SendByte</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span> Byte)</span></span><br><span class="line">&#123;</span><br><span class="line">	SBUF = Byte;		<span class="comment">//写入寄存器</span></span><br><span class="line">	<span class="keyword">while</span>(TI == <span class="number">0</span>);		</span><br><span class="line">	TI = <span class="number">0</span>;  <span class="comment">//重置接收中断请求标志位。</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//模板</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">void UART_Routine()		interrupt 4</span></span><br><span class="line"><span class="comment">&#123;</span></span><br><span class="line"><span class="comment">	if(RI == 1)	//判断接收</span></span><br><span class="line"><span class="comment">	&#123;</span></span><br><span class="line"><span class="comment">		P2=SBUF;</span></span><br><span class="line"><span class="comment">		RI=0;</span></span><br><span class="line"><span class="comment">	&#125;</span></span><br><span class="line"><span class="comment">&#125;</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="comment">/*									UART.c									*/</span></span><br></pre></td></tr></table></figure>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="http://randolfluo.github.io">Randolf luo</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="http://randolfluo.github.io/2024/02/05/51%E5%8D%95%E7%89%87%E6%9C%BA/51%E5%8D%95%E7%89%87%E6%9C%BA0x1/">http://randolfluo.github.io/2024/02/05/51%E5%8D%95%E7%89%87%E6%9C%BA/51%E5%8D%95%E7%89%87%E6%9C%BA0x1/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来源 <a href="http://randolfluo.github.io" target="_blank">Randolfluo's blog</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E5%8D%95%E7%89%87%E6%9C%BA/">单片机</a><a class="post-meta__tags" href="/tags/51%E5%8D%95%E7%89%87%E6%9C%BA/">51单片机</a></div><div class="post-share"><div class="social-share" data-image="/img/cover1.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related" href="/2024/02/01/csapp/%E7%AC%AC6%E7%AB%A0%E2%80%94%E2%80%94%E5%AD%98%E5%82%A8%E5%99%A8%E5%B1%82%E6%AC%A1%E7%BB%93%E6%9E%84/" title="csapp第六章——存储器层次结构"><img class="cover" src="/img/cover1.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="info"><div class="info-1"><div class="info-item-1">上一篇</div><div class="info-item-2">csapp第六章——存储器层次结构</div></div><div class="info-2"><div class="info-item-1">存储器层次结构计算机技术的成功很大程度上源自于存储技术的巨大进步 。 随机访问存储器静态RAM 由于 SRAM 存储器单元的双稳态特性，只要有电，它就会永远地保持它的值。 动态RAMDRAM 将每个位存储为对每个电容的充电。与 SRAM 不同， DRAM 存储器单元对干扰非常敏感 。  传统的DRAMDRAM 芯片中的单元（位）被分成d 个超单元 (supercell) , 每个超单元都个DRAM单元组成。 d*w 的DRAM 总共存储了d w位信息。  图示为168 DRAM 芯片的组织，有 d=l6 个超单元，每个超单元有 w=8 位， r=4 行，c=4 。   将 DRAM 组织成二维阵列而不是线性数组的一个原因是降低芯片上地址引脚的数量。  二维阵列组织的缺点是必须分两步发送地址，这增加了访问时间。   内存模块DRAM 芯片封装在内存模块 (memory module) 中，它插到主板的扩展槽上 。 内存控制器将超单元地址 发送到内存模块，然后内存模块再广播到每个 DRAM 。作为响应，每个DRAM...</div></div></div></a><a class="pagination-related" href="/2024/02/13/csapp/%E7%AC%AC8%E7%AB%A0%E2%80%94%E2%80%94%E5%BC%82%E5%B8%B8%E6%8E%A7%E5%88%B6%E6%B5%81/" title="csapp第八章——异常控制流"><img class="cover" src="/img/cover1.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="info text-right"><div class="info-1"><div class="info-item-1">下一篇</div><div class="info-item-2">csapp第八章——异常控制流</div></div><div class="info-2"><div class="info-item-1">[TOC] 异常控制流现代系统通过使控制流发生突变来对系统状态的变化做出反应 。一般而言 ，我们把这些突变称为异常控制流 (Exceptional Control Flow, ECF) 。 异常异常是异常控制流的一种形式，它一部分由硬件实现，一部分由操作系统实现。  异常 (exception) 就是控制流中的突变，用来响应处理器状态中的某些变化。 当处理器检测到有事件发生时，它就会通过一张叫做异常表 (exception table)的跳转表，进行一个间接过程调用（异常），到一个专门设计用来处理这类事件的操作系统子程序（异常处理程序 (exception handler)) 。 异常处理 异常处理程序运行在内核模式下，这意味它们对所有的系统资源都有完全的访问权限。 异常的类别  同步异步表示的结果的获取方式是主动获取还是被动接收；阻塞非阻塞表示的是获取这个动作是否可以立即返回不用等待。  中断中断是异步发生的， 是来自处理器外部的 I/0 设备的信号的结果。例如定时器计时结束后会向处理器发送一个中断。  陷阱和系统调用陷阱是有意的异常，是执行一条指令的结果...</div></div></div></a></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><a class="pagination-related" href="/2024/02/27/51%E5%8D%95%E7%89%87%E6%9C%BA/51%E5%8D%95%E7%89%87%E6%9C%BA0x2/" title="51单片机学习0x2"><img class="cover" src="/img/cover1.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2024-02-27</div><div class="info-item-2">51单片机学习0x2</div></div><div class="info-2"><div class="info-item-1">0x2LED点阵屏 LED点阵屏的结构类似于数码管，只不过是数码管把每一列的像素以“8”字型排列而已  LED点阵屏与数码管一样，有共阴和共阳两种接法，不同的接法对应的电路结构不同  LED点阵屏需要进行逐行或逐列扫描，才能使所有LED同时显示   LED点阵屏分类  按颜色：单色、双色（可显示三种颜色）、全彩  按像素：8-8、16-16等    74HC595 74HC595是串行输入并行输出的移位寄存器，可用3根线输入串行数据，8根线输出并行数据，多片级联后，可输出16位、24位、32位等，常用于IO口扩展。   相当于一把手枪，SER填入子弹，SERCLK控制子弹装填（移位），多余的子弹从QH&#39;口溢出，RCLK清空弹夹。同时，还可以将多个74HC595串联，拓展IO口。 要注意J24模块GND端,用文字取模软件生成代码 ...</div></div></div></a><a class="pagination-related" href="/2024/02/15/stm32/stm32%E5%8D%95%E7%89%87%E6%9C%BA0x1/" title="stm32单片机0x1"><img class="cover" src="/img/cover1.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2024-02-15</div><div class="info-item-2">stm32单片机0x1</div></div><div class="info-2"><div class="info-item-1">stm32STM32是ST公司基于ARM Cortex-M内核开发的32位微控制器  ARM内核 stm32F103C8T6采用Cortex-M3内核，发布于2004年10月。  片上资源/外设     英文缩写 名称 英文缩写 名称     NVIC 嵌套向量中断控制器 CAN CAN通信   SysTick 系统滴答定时器 USB USB通信   RCC 复位和时钟控制 RTC 实时时钟   GPIO 通用IO口 CRC CRC校验   AFIO 复用IO口 PWR 电源控制   EXTI 外部中断 BKP 备份寄存器   TIM 定时器 IWDG 独立看门狗   ADC 模数转换器 WWDG 窗口看门狗   DMA 直接内存访问 DAC 数模转换器   USART 同步/异步串口通信 SDIO SD卡接口   I2C I2C通信 FSMC 可变静态存储控制器   SPI SPI通信 USB...</div></div></div></a></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/img/avater.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">Randolf luo</div><div class="author-info-description">今日事，今日毕</div><div class="site-data"><a href="/archives/"><div class="headline">文章</div><div class="length-num">111</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">33</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">34</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/xxxxxx"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons"><a class="social-icon" href="https://github.com/Randolfluo" target="_blank" title="Github"><i class="fab fa-github" style="color: #24292e;"></i></a><a class="social-icon" href="mailto:lrj3216610@163.com" target="_blank" title="Email"><i class="fas fa-envelope" style="color: #4a7dbe;"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8D%95%E7%89%87%E6%9C%BA"><span class="toc-number">1.</span> <span class="toc-text">单片机</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#51%E5%8D%95%E7%89%87%E6%9C%BA"><span class="toc-number">1.1.</span> <span class="toc-text">51单片机</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%8A%AF%E7%89%87"><span class="toc-number">1.1.1.</span> <span class="toc-text">芯片</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%8D%95%E7%89%87%E6%9C%BA%E7%AE%A1%E8%84%9A%E5%9B%BE"><span class="toc-number">1.1.2.</span> <span class="toc-text">单片机管脚图</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%8D%95%E7%89%87%E6%9C%BA%E6%9C%80%E5%B0%8F%E7%B3%BB%E7%BB%9F"><span class="toc-number">1.1.3.</span> <span class="toc-text">单片机最小系统</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#51%E5%8D%95%E7%89%87%E6%9C%BA%E4%B8%8Estm32%E5%8D%95%E7%89%87%E6%9C%BA%E7%9A%84%E5%8C%BA%E5%88%AB"><span class="toc-number">1.2.</span> <span class="toc-text">51单片机与stm32单片机的区别</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link"><span class="toc-number"></span> <span class="toc-text"></span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#LED"><span class="toc-number">1.</span> <span class="toc-text">LED</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%8B%AC%E7%AB%8B%E6%8C%89%E9%94%AE%E6%8E%A7%E5%88%B6"><span class="toc-number">2.</span> <span class="toc-text">独立按键控制</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B0%E7%A0%81%E7%AE%A1"><span class="toc-number">3.</span> <span class="toc-text">数码管</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A8%A1%E5%9D%97%E5%8C%96%E7%BC%96%E7%A8%8B"><span class="toc-number">4.</span> <span class="toc-text">模块化编程</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#LCD1602-%E6%B6%B2%E6%99%B6%E5%B1%8F"><span class="toc-number">5.</span> <span class="toc-text">LCD1602 液晶屏</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%9F%A9%E9%98%B5%E9%94%AE%E7%9B%98"><span class="toc-number">6.</span> <span class="toc-text">矩阵键盘</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%89%AB%E6%8F%8F%E7%9A%84%E6%A6%82%E5%BF%B5"><span class="toc-number">6.1.</span> <span class="toc-text">扫描的概念</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%9F%A9%E9%98%B5%E9%94%AE%E7%9B%98%E5%AF%86%E7%A0%81%E9%94%81-8%E4%BD%8D"><span class="toc-number">7.</span> <span class="toc-text">矩阵键盘密码锁(8位)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%9A%E6%97%B6%E5%99%A8"><span class="toc-number">8.</span> <span class="toc-text">定时器</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#CPU-%E6%97%B6%E5%BA%8F%E7%9A%84%E6%9C%89%E5%85%B3%E7%9F%A5%E8%AF%86"><span class="toc-number">8.1.</span> <span class="toc-text">CPU 时序的有关知识</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%B8%AD%E6%96%AD%E7%B3%BB%E7%BB%9F"><span class="toc-number">8.2.</span> <span class="toc-text">中断系统</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%B2%E5%8F%A3"><span class="toc-number">9.</span> <span class="toc-text">串口</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%94%B5%E5%B9%B3%E6%A0%87%E5%87%86"><span class="toc-number">9.1.</span> <span class="toc-text">电平标准</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%80%9A%E4%BF%A1%E6%9C%AF%E8%AF%AD"><span class="toc-number">9.2.</span> <span class="toc-text">通信术语</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%B8%B8%E8%A7%81%E9%80%9A%E4%BF%A1%E6%8E%A5%E5%8F%A3"><span class="toc-number">9.3.</span> <span class="toc-text">常见通信接口</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2024/11/11/dailyrecord/2024_11_11/" title="记一次2024ICPC杭州站"><img src="/img/cover2.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="记一次2024ICPC杭州站"/></a><div class="content"><a class="title" href="/2024/11/11/dailyrecord/2024_11_11/" title="记一次2024ICPC杭州站">记一次2024ICPC杭州站</a><time datetime="2024-11-10T16:00:00.000Z" title="发表于 2024-11-11 00:00:00">2024-11-11</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/10/15/math/%E9%AB%98%E7%AD%89%E6%95%B0%E5%AD%A6/" title="无标题"><img src="/img/cover2.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="无标题"/></a><div class="content"><a class="title" href="/2024/10/15/math/%E9%AB%98%E7%AD%89%E6%95%B0%E5%AD%A6/" title="无标题">无标题</a><time datetime="2024-10-15T06:44:44.734Z" title="发表于 2024-10-15 14:44:44">2024-10-15</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/09/29/potato_clock/v0.01/" title="无标题"><img src="/img/cover1.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="无标题"/></a><div class="content"><a class="title" href="/2024/09/29/potato_clock/v0.01/" title="无标题">无标题</a><time datetime="2024-09-29T06:08:49.443Z" title="发表于 2024-09-29 14:08:49">2024-09-29</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/09/26/%E7%AE%97%E6%B3%95/%E6%B4%9B%E8%B0%B7%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%840x2/" title="无标题"><img src="/img/cover2.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="无标题"/></a><div class="content"><a class="title" href="/2024/09/26/%E7%AE%97%E6%B3%95/%E6%B4%9B%E8%B0%B7%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%840x2/" title="无标题">无标题</a><time datetime="2024-09-26T12:40:48.042Z" title="发表于 2024-09-26 20:40:48">2024-09-26</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/09/26/pr/pr%E5%85%A5%E9%97%A8/" title="无标题"><img src="/img/cover1.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="无标题"/></a><div class="content"><a class="title" href="/2024/09/26/pr/pr%E5%85%A5%E9%97%A8/" title="无标题">无标题</a><time datetime="2024-09-26T12:40:47.924Z" title="发表于 2024-09-26 20:40:47">2024-09-26</time></div></div></div></div></div></div></main><footer id="footer" style="background-image: url(/img/cover1.jpg);"><div id="footer-wrap"><div class="copyright">&copy;2022 - 2024 By Randolf luo</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="footer_custom_text">Welcome to my blog!</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="translateLink" type="button" title="简繁转换">簡</button><button id="darkmode" type="button" title="日间和夜间模式切换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js"></script><div class="js-pjax"><script>(() => {
  const loadMathjax = () => {
    if (!window.MathJax) {
      window.MathJax = {
        tex: {
          inlineMath: [['$', '$'], ['\\(', '\\)']],
          tags: 'none',
        },
        chtml: {
          scale: 1.1
        },
        options: {
          enableMenu: true,
          renderActions: {
            findScript: [10, doc => {
              for (const node of document.querySelectorAll('script[type^="math/tex"]')) {
                const display = !!node.type.match(/; *mode=display/)
                const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display)
                const text = document.createTextNode('')
                node.parentNode.replaceChild(text, node)
                math.start = {node: text, delim: '', n: 0}
                math.end = {node: text, delim: '', n: 0}
                doc.math.push(math)
              }
            }, '']
          }
        }
      }
      
      const script = document.createElement('script')
      script.src = 'https://cdn.jsdelivr.net/npm/mathjax/es5/tex-mml-chtml.min.js'
      script.id = 'MathJax-script'
      script.async = true
      document.head.appendChild(script)
    } else {
      MathJax.startup.document.state(0)
      MathJax.texReset()
      MathJax.typesetPromise()
    }
  }

  btf.addGlobalFn('encrypt', loadMathjax, 'mathjax')
  window.pjax ? loadMathjax() : window.addEventListener('load', loadMathjax)
})()</script><script>(() => {
  const runMermaid = ele => {
    window.loadMermaid = true
    const theme = document.documentElement.getAttribute('data-theme') === 'dark' ? 'dark' : 'default'

    ele.forEach((item, index) => {
      const mermaidSrc = item.firstElementChild
      const mermaidThemeConfig = `%%{init:{ 'theme':'${theme}'}}%%\n`
      const mermaidID = `mermaid-${index}`
      const mermaidDefinition = mermaidThemeConfig + mermaidSrc.textContent

      const renderFn = mermaid.render(mermaidID, mermaidDefinition)
      const renderMermaid = svg => {
        mermaidSrc.insertAdjacentHTML('afterend', svg)
      }

      // mermaid v9 and v10 compatibility
      typeof renderFn === 'string' ? renderMermaid(renderFn) : renderFn.then(({ svg }) => renderMermaid(svg))
    })
  }

  const codeToMermaid = () => {
    const codeMermaidEle = document.querySelectorAll('pre > code.mermaid')
    if (codeMermaidEle.length === 0) return

    codeMermaidEle.forEach(ele => {
      const preEle = document.createElement('pre')
      preEle.className = 'mermaid-src'
      preEle.hidden = true
      preEle.textContent = ele.textContent
      const newEle = document.createElement('div')
      newEle.className = 'mermaid-wrap'
      newEle.appendChild(preEle)
      ele.parentNode.replaceWith(newEle)
    })
  }

  const loadMermaid = () => {
    if (true) codeToMermaid()
    const $mermaid = document.querySelectorAll('#article-container .mermaid-wrap')
    if ($mermaid.length === 0) return

    const runMermaidFn = () => runMermaid($mermaid)
    btf.addGlobalFn('themeChange', runMermaidFn, 'mermaid')
    window.loadMermaid ? runMermaidFn() : btf.getScript('https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js').then(runMermaidFn)
  }

  btf.addGlobalFn('encrypt', loadMermaid, 'mermaid')
  window.pjax ? loadMermaid() : document.addEventListener('DOMContentLoaded', loadMermaid)
})()</script></div><canvas class="fireworks" mobile="false"></canvas><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/fireworks.min.js"></script><script defer="defer" id="fluttering_ribbon" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/canvas-fluttering-ribbon.min.js"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="text-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js"></script></div></div></body></html>